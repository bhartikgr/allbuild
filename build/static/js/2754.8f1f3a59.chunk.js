"use strict";(self.webpackChunkamourette=self.webpackChunkamourette||[]).push([[2754],{2754:(e,s,n)=>{n.d(s,{A:()=>A});var l=n(5043),a=n(5475),c=n(3118),r=n(7671),i=n(7354),o=n(6213),t=n(2806),d=n(9705),m=(n(8856),n(8753)),u=n(6548),h=n(5455),x=n(6438),p=n(9513),g=n(2608),f=n(2459),j=n(1330),v=(n(7035),n(7070)),N=n(2821),w=n(9932),_=n(3216),y=n(8908),b=n(4117),S=n(2862),k=n(579);const A=function(e){let{refreshNotifications:s}=e;var A="https://backend.amourette.no/api/profile/";const[L,E]=(0,l.useState)(""),[C,I]=(0,l.useState)(!1),[M,q]=(0,l.useState)([]),[O,D]=(0,l.useState)(""),[J,R]=(0,l.useState)(navigator.onLine),[T,F]=(0,l.useState)(""),[U,B]=(0,l.useState)(!1),[P,W]=(0,l.useState)(""),[$,G]=(0,l.useState)(""),Y=(0,_.zy)(),H=new URLSearchParams(Y.search).get("q")||"",[Z,z]=(0,l.useState)(H),Q=e=>{ne(se===e?null:e),te()},[K,V]=(0,l.useState)(!1),[X,ee]=(0,l.useState)(""),[se,ne]=(0,l.useState)(null),[le,ae]=(0,l.useState)(!1),ce=()=>{window.scrollY>0?ae(!0):ae(!1)},re=(0,_.Zp)();(0,l.useEffect)((()=>{const e=new WebSocket("wss://backend.amourette.no");return e.onmessage=e=>{try{const n=JSON.parse(e.data);console.log(n);const l=localStorage.getItem("userLogin"),a=l?JSON.parse(l):null;"friendrequestacceptnotification"===n.event&&Array.isArray(n.user_id)&&n.user_id.some((e=>e.id===a.id))&&s(),"gallerynotification"===n.event&&Array.isArray(n.user_id)&&n.user_id.some((e=>e.id===a.id))&&s(),"grouprequest_acceptnotification"===n.event&&Array.isArray(n.user_id)&&n.user_id.some((e=>e.id===a.id))&&s(),"eventrequest_acceptnotification"===n.event&&Array.isArray(n.user_id)&&n.user_id.some((e=>e.id===a.id))&&s()}catch(n){console.error("Failed to parse WebSocket message:",n),console.error("Raw message:",e.data)}},e.onopen=()=>{console.log("WebSocket connection established")},e.onerror=e=>{console.error("WebSocket error:",e)},()=>{e.close(),console.log("WebSocket connection closed")}}),[s]),(0,l.useEffect)((()=>{const e=localStorage.getItem("userLogin"),s=JSON.parse(e);return console.log("dff"),console.log(s),null!==s&&"null"!==s||(localStorage.removeItem("userLogin"),window.location.reload("/login")),de(),te(),window.addEventListener("scroll",ce),()=>{window.removeEventListener("scroll",ce)}}),[]);const ie=async()=>{const e=localStorage.getItem("userLogin");if(e){const n={user_id:JSON.parse(e).id};try{const e=await o.A.post(A+"/setonline",n,{headers:{Accept:"application/json","Content-Type":"application/json"}});F(e.data.onlineCount)}catch(s){console.error("Error setting user online:",s.response?s.response.data:s.message)}}},oe=async()=>{const e=localStorage.getItem("userLogin");if(e){const n={user_id:JSON.parse(e).id};try{await o.A.post(A+"/setoffline",n,{headers:{Accept:"application/json","Content-Type":"application/json"}})}catch(s){console.error("Error setting user offline:",s.response?s.response.data:s.message)}}};(0,l.useEffect)((()=>{J?ie():oe();const e=()=>{R(!0)},s=()=>{R(!1)};return window.addEventListener("online",e),window.addEventListener("offline",s),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",s)}}),[]),(0,l.useEffect)((()=>{J?ie():oe()}),[J]);const te=async()=>{const e=localStorage.getItem("userLogin");let s={user_id:JSON.parse(e).id};try{var n=(await o.A.post(A+"getReceivedMessage",s,{headers:{Accept:"application/json","Content-Type":"application/json"}})).data.results;q(n)}catch(l){l.response||l.request}},de=async()=>{const e=localStorage.getItem("userLogin"),s=JSON.parse(e);let n={email:s.email,id:s.id};try{const e=await o.A.post("https://backend.amourette.no/api/getUserDetail",n,{headers:{Accept:"application/json","Content-Type":"application/json"}});console.log("sd"),""===e.data.result&&(localStorage.removeItem("userLogin"),re("/login")),console.log(e.data),ee(e.data.result)}catch(l){l.response||(l.request?console.error("Request data:",l.request):console.error("Error message:",l.message))}},me=e=>{if(!e)return null;const s=new Date(e),n={timeZone:"Europe/Oslo",year:"numeric",month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1},l=new Intl.DateTimeFormat("en-US",n).format(s),a=new Date,c=new Intl.DateTimeFormat("en-US",n).format(a),r=new Date(l),i=new Date(c),o=Math.floor((i-r)/1e3),t=[{label:"year",seconds:31536e3},{label:"month",seconds:2592e3},{label:"day",seconds:86400},{label:"hour",seconds:3600},{label:"minute",seconds:60},{label:"second",seconds:1}];for(const d of t){const e=Math.floor(o/d.seconds);if(e>=1)return`${e} ${d.label}${e>1?"s":""} ago`}return"Just now"},ue=e=>{S.A.changeLanguage(e),localStorage.setItem("language",e)},{t:he}=(0,b.Bd)();return(0,l.useEffect)((()=>{let e=["/searchpeople","/searchpost","/searchgroup","/searchevent","/searchforum","/searchmember","/searchspeeddate"].includes(Y.pathname)?Y.pathname:"/searchtop?q="+P;setTimeout((()=>{E(e)}),100)}),[Y.pathname,P]),(0,l.useEffect)((()=>{const e=localStorage.getItem("language")||"en";console.log("language"),console.log(e),S.A.language!==e&&S.A.changeLanguage(e),console.log(he("LeftMenu_yourprofile"))}),[S.A,he]),(0,l.useEffect)((()=>{const e=e=>{if(console.log(L),""!==L&&""!==P.trim()&&"Enter"===e.key){e.preventDefault();let s=L.includes("?q=")?L:`${L}?q=${encodeURIComponent(P)}`;window.location.href=s}};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[L,P]),(0,k.jsxs)(k.Fragment,{children:[U&&(0,k.jsx)(y.A,{message:$}),(0,k.jsx)("header",{className:"header "+(le?"sticky":""),children:(0,k.jsx)("div",{className:"container-lg",children:(0,k.jsxs)("div",{className:"row gy-3 align-items-center",children:[(0,k.jsx)("div",{className:"col-md-3",children:(0,k.jsx)(a.N_,{to:"/",className:"toplogo d-inline-block fulw",children:(0,k.jsx)("img",{src:t,alt:"Logo"})})}),(0,k.jsx)("div",{className:"col-md-3",children:(0,k.jsxs)("div",{className:"d-block topsearch",children:[(0,k.jsx)("form",{action:"",children:(0,k.jsx)("input",{type:"text",value:P,placeholder:he("headerSearch"),onInput:e=>{const s=e.target.value;z(s),W(s),I(!0);const n=["/searchpeople","/searchpost","/searchgroup","/searchevent","/searchforum","/searchmember","/searchspeeddate"];""!==s?I(!0):(n.includes(Y.pathname)&&(window.location.href=Y.pathname),I(!1))}})}),C&&(0,k.jsx)("ul",{className:"similar_search",children:(0,k.jsx)("li",{children:(0,k.jsxs)("a",{href:L,children:[(0,k.jsx)("div",{className:"block search_icon",children:(0,k.jsx)("img",{className:"w-100 h-100 object-fit-cover",src:n(4319),alt:"Profile"})}),(0,k.jsx)("span",{children:P})]})})})]})}),(0,k.jsx)("div",{className:"col-md-6",children:(0,k.jsx)("div",{className:"d-flex flex-column flex-md-row  justify-content-md-end",children:(0,k.jsx)("div",{className:"d-flex flex-column flex-md-row ",children:(0,k.jsxs)("div",{className:"d-flex gap-3 rel flex-wrap align-items-md-center justify-content-between justify-content-md-end",children:[(0,k.jsxs)("div",{className:"",children:[(0,k.jsx)("button",{type:"button",className:"topmenu "+("menu1"===se?"active":""),onClick:()=>Q("menu1"),children:(0,k.jsx)("img",{src:d,alt:"userp"})}),(0,k.jsx)("div",{className:"menubox",style:{display:"menu1"===se?"block":"none"},children:(0,k.jsxs)("div",{className:"d-flex flex-column gap-4 ",children:[(0,k.jsx)("h3",{children:he("Menu")}),(0,k.jsxs)("div",{className:"d-flex flex-column gap-3",children:[(0,k.jsxs)(a.N_,{to:"/friendsearch",className:"d-flex gap-3",children:[(0,k.jsx)("div",{className:"flex-shrink-0",children:(0,k.jsx)("div",{className:"iconmenu fulw",children:(0,k.jsx)("img",{src:u,alt:"userpic"})})}),(0,k.jsxs)("div",{className:"flex-grow-1",children:[(0,k.jsx)("h4",{children:he("LeftMenu_Members")}),(0,k.jsx)("p",{children:he("view_and_browser")})]})]}),(0,k.jsxs)(a.N_,{to:"/receivedmessages",className:"d-flex gap-3",children:[(0,k.jsx)("div",{className:"flex-shrink-0",children:(0,k.jsx)("div",{className:"iconmenu fulw",children:(0,k.jsx)("img",{src:h,alt:"userpic"})})}),(0,k.jsxs)("div",{className:"flex-grow-1",children:[(0,k.jsx)("h4",{children:he("Messages")}),(0,k.jsx)("p",{children:he("view_received_and_sent")})]})]}),(0,k.jsxs)(a.N_,{to:"/allgallery",className:"d-flex gap-3",children:[(0,k.jsx)("div",{className:"flex-shrink-0",children:(0,k.jsx)("div",{className:"iconmenu fulw",children:(0,k.jsx)("img",{src:x,alt:"userpic"})})}),(0,k.jsxs)("div",{className:"flex-grow-1",children:[(0,k.jsx)("h4",{children:he("Gallery")}),(0,k.jsx)("p",{children:he("view_and_upload_images")})]})]}),(0,k.jsxs)(a.N_,{to:"/allgroup",className:"d-flex gap-3",children:[(0,k.jsx)("div",{className:"flex-shrink-0",children:(0,k.jsx)("div",{className:"iconmenu fulw",children:(0,k.jsx)("img",{src:p,alt:"userpic"})})}),(0,k.jsxs)("div",{className:"flex-grow-1",children:[(0,k.jsx)("h4",{children:he("Groups")}),(0,k.jsx)("p",{children:he("Browse_and_create_groups")})]})]}),(0,k.jsxs)(a.N_,{to:"/allevents",className:"d-flex gap-3",children:[(0,k.jsx)("div",{className:"flex-shrink-0",children:(0,k.jsx)("div",{className:"iconmenu fulw",children:(0,k.jsx)("img",{src:g,alt:"userpic"})})}),(0,k.jsxs)("div",{className:"flex-grow-1",children:[(0,k.jsx)("h4",{children:he("LeftMenu_Events")}),(0,k.jsx)("p",{children:he("Browse_and_create_events")})]})]}),(0,k.jsxs)(a.N_,{to:"/speeddate",className:"d-flex gap-3",children:[(0,k.jsx)("div",{className:"flex-shrink-0",children:(0,k.jsx)("div",{className:"iconmenu fulw",children:(0,k.jsx)("img",{src:f,alt:"userpic"})})}),(0,k.jsxs)("div",{className:"flex-grow-1",children:[(0,k.jsx)("h4",{children:he("LeftMenu_Speedating")}),(0,k.jsx)("p",{children:he("Meet_new_people")})]})]}),(0,k.jsxs)(a.N_,{to:"/forumsection",className:"d-flex gap-3",children:[(0,k.jsx)("div",{className:"flex-shrink-0",children:(0,k.jsx)("div",{className:"iconmenu fulw",children:(0,k.jsx)("img",{src:j,alt:"userpic"})})}),(0,k.jsxs)("div",{className:"flex-grow-1",children:[(0,k.jsx)("h4",{children:he("Forum")}),(0,k.jsx)("p",{children:he("Browse_and_create_forum_threads")})]})]})]})]})})]}),(0,k.jsx)(i.A,{activeMenu:se,toggleMenu:Q,refresh:s}),(0,k.jsxs)("div",{className:"",children:[(0,k.jsx)("button",{type:"button",className:"topmenu "+("menu3"===se?"active":""),onClick:()=>Q("menu3"),children:(0,k.jsx)("img",{className:"object-fit-contain",src:m,alt:"userp"})}),(0,k.jsx)("div",{className:"menubox",style:{display:"menu3"===se?"block":"none"},children:(0,k.jsxs)("div",{className:"d-flex flex-column gap-4 ",children:[(0,k.jsx)("h3",{children:he("Inbox")}),(0,k.jsx)("div",{className:"d-block inboxser",children:(0,k.jsx)("form",{action:"",children:(0,k.jsx)("input",{type:"text",value:O,onChange:async e=>{const s=localStorage.getItem("userLogin"),n=JSON.parse(s);D(e.target.value);let l={search:e.target.value,user_id:n.id};try{var a=(await o.A.post(A+"getReceivedMessageSearch",l,{headers:{Accept:"application/json","Content-Type":"application/json"}})).data.results;q(a)}catch(c){c.response||c.request}},placeholder:"Search inbox..."})})}),(0,k.jsx)("div",{className:"d-flex flex-column gap-3",children:(0,k.jsx)("div",{className:"d-flex flex-column gap-3 scroll_bar scrollyover",children:0===M.length?(0,k.jsx)("p",{children:he("No_inbox_found")}):M.map((e=>(0,k.jsxs)(a.N_,{to:"javascript:void(0)",className:"d-flex gap-3",children:[(0,k.jsx)("div",{className:"flex-shrink-0",children:(0,k.jsx)("div",{className:"iconmenu ofit rounded-circle overflow-hidden",children:e.sender_profile?(0,k.jsx)("img",{src:e.sender_profile,alt:"userpic"}):(0,k.jsx)("img",{src:n(7123),alt:"userpic"})})}),(0,k.jsxs)("div",{className:"flex-grow-1",children:[(0,k.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,k.jsx)("h4",{children:e.sender_username}),(0,k.jsx)("p",{className:"",children:me(e.date)})]}),(0,k.jsx)("h6",{className:"minimsg",children:e.message})]})]},e.id)))})})]})})]}),(0,k.jsxs)("div",{className:"",children:[(0,k.jsx)("button",{type:"button",className:"topmenu rounded-circle overflow-hidden p-0 "+("menu4"===se?"active":""),onClick:()=>Q("menu4"),children:(0,k.jsx)("img",{src:X.profile_image,alt:"userp",className:"rounded-circle overflow-hidden"})}),(0,k.jsx)("div",{className:"menubox",style:{display:"menu4"===se?"block":"none"},children:(0,k.jsxs)("div",{className:"d-flex flex-column gap-4 ",children:[(0,k.jsx)("h3",{children:he("Profile_and_settings")}),(0,k.jsxs)("div",{className:"d-flex flex-column gap-3",children:[(0,k.jsxs)(a.N_,{to:"/editprofile",className:"d-flex gap-3",children:[(0,k.jsx)("div",{className:"flex-shrink-0",children:(0,k.jsx)("div",{className:"iconmenu ofit rounded-circle overflow-hidden",children:X.profile_image?(0,k.jsx)("img",{src:X.profile_image,alt:"userpic"}):(0,k.jsx)("img",{src:n(7123),alt:"userpic"})})}),(0,k.jsxs)("div",{className:"flex-grow-1",children:[(0,k.jsx)("h4",{children:X.username}),(0,k.jsx)("p",{children:he("Edit_your_profile")})]})]}),(0,k.jsx)("div",{className:"d-block morebtn",children:(0,k.jsx)("button",{type:"button",onClick:()=>{V(!0),document.body.style.overflowY="hidden"},children:he("UPGRADE_MEMBERSHIP")})}),(0,k.jsxs)("div",{className:"d-flex flex-column gap-3 helpset pt-3",children:[(0,k.jsxs)(a.N_,{to:"/setting",className:"d-flex gap-3",children:[(0,k.jsx)("div",{className:"flex-shrink-0",children:(0,k.jsx)("div",{className:"iconmenu fulw",children:(0,k.jsx)("img",{src:v,alt:"userpic"})})}),(0,k.jsxs)("div",{className:"flex-grow-1",children:[(0,k.jsx)("h4",{children:he("Settings")}),(0,k.jsx)("p",{children:he("Site_and_profile_settings")})]})]}),(0,k.jsxs)(a.N_,{to:"/helpsupport",className:"d-flex gap-3",children:[(0,k.jsx)("div",{className:"flex-shrink-0",children:(0,k.jsx)("div",{className:"iconmenu fulw",children:(0,k.jsx)("img",{src:w,alt:"userpic"})})}),(0,k.jsxs)("div",{className:"flex-grow-1",children:[(0,k.jsx)("h4",{children:he("Help_and_support")}),(0,k.jsx)("p",{children:he("Contact_us_FAQ_and_more")})]})]}),(0,k.jsxs)(a.N_,{to:"/logout",className:"d-flex gap-3",children:[(0,k.jsx)("div",{className:"flex-shrink-0",children:(0,k.jsx)("div",{className:"iconmenu fulw",children:(0,k.jsx)("img",{src:N,alt:"userpic"})})}),(0,k.jsxs)("div",{className:"flex-grow-1",children:[(0,k.jsx)("h4",{children:he("Log_out")}),(0,k.jsx)("p",{children:he("See_you_later")})]})]})]})]})]})})]}),(0,k.jsxs)("div",{className:"d-flex align-items-center gap-1 lang_chnage",children:[(0,k.jsx)("button",{className:"flex-shrink-0 "+("en"===S.A.language?"active":""),type:"button",onClick:()=>ue("en"),children:"EN"}),(0,k.jsx)("h6",{className:"flex-shrink-0",children:"-"}),(0,k.jsx)("button",{className:"flex-shrink-0 "+("no"===S.A.language?"active":""),type:"button",onClick:()=>ue("no"),children:"NO"})]})]})})})})]})})}),(0,k.jsx)(r.l,{isOpen:K,onClose:()=>{V(!1),document.body.style.overflowY="auto"}}),(0,k.jsx)(c.A,{})]})}}}]);
//# sourceMappingURL=2754.8f1f3a59.chunk.js.map