"use strict";(self.webpackChunkamourette=self.webpackChunkamourette||[]).push([[5700],{5700:(e,s,a)=>{a.d(s,{A:()=>E});var n=a(5043),r=a(5475),t=a(3118),l=a(7671),i=a(7354),o=a(6213),c=a(2806),d=a(9705),u=(a(8856),a(8753)),m=a(6548),h=a(5455),p=a(6438),x=a(9513),g=a(2608),f=a(2459),j=a(1330),v=(a(7035),a(7070)),N=a(2821),_=a(9932),w=a(3216),y=a(8908),b=a(4117),S=a(2862),k=a(4572),A=a(579);const E=function(e){let{refreshNotifications:s}=e;const E=(0,w.zy)(),I=new URLSearchParams(E.search).get("q")||"",[L,C]=(0,n.useState)(I);var M="https://backend.amourette.no/api/profile/";const q=(0,n.useRef)(null),T=localStorage.getItem("userLogin"),P=JSON.parse(T),[O,$]=(0,n.useState)(""),[G,J]=(0,n.useState)(!1),[R,D]=(0,n.useState)([]),[B,F]=(0,n.useState)(""),[U,W]=(0,n.useState)(navigator.onLine),[Y,H]=(0,n.useState)(""),[Z,z]=(0,n.useState)(!1),[Q,K]=(0,n.useState)(""),[V,X]=(0,n.useState)(""),[ee,se]=(0,n.useState)([]),[ae,ne]=(0,n.useState)(""),[re,te]=(0,n.useState)(!1),le=e=>{me(ue===e?null:e),_e()},[ie,oe]=(0,n.useState)(!1),[ce,de]=(0,n.useState)(""),[ue,me]=(0,n.useState)(null),[he,pe]=(0,n.useState)(!1),xe=()=>{window.scrollY>0?pe(!0):pe(!1)},ge=(0,w.Zp)();(0,n.useEffect)((()=>{fe()}),[]);const fe=async()=>{const e=localStorage.getItem("userLogin");if(e){const n={user_id:JSON.parse(e).id};try{const e=await o.A.post("https://backend.amourette.no/api/members/checkmembership",n,{headers:{Accept:"application/json","Content-Type":"application/json"}});var s=e.data.result[0];e.data.result.length>0?(!0===e.data.status&&(ge("/dashboard"),oe(!0),setTimeout((()=>{K("")}),3e3)),"Inactive"!==s.status&&"Banned"!==s.status||(localStorage.removeItem("userLogin"),localStorage.removeItem("userSearch"),window.location.reload("/login"))):(localStorage.removeItem("userLogin"),localStorage.removeItem("userSearch"),window.location.reload("/login"))}catch(a){console.error("Error setting user online:",a.response?a.response.data:a.message)}}};(0,n.useEffect)((()=>{const e=new WebSocket("wss://backend.amourette.no");return e.onmessage=e=>{try{const a=JSON.parse(e.data),n=localStorage.getItem("userLogin"),r=n?JSON.parse(n):null;"sendfriendRequest"===a.event&&a.user_id===r.id&&s(),"Deletegallery"===a.event&&s(),"friendrequestacceptnotification"===a.event&&Array.isArray(a.user_id)&&a.user_id.some((e=>e.id===r.id))&&(te(!0),s()),"adminNotification"===a.event&&Array.isArray(a.user_id)&&a.user_id.includes(r.id)&&(te(!0),s()),"adminEventupdate"===a.event&&Array.isArray(a.user_id)&&a.user_id.includes(r.id)&&(te(!0),s()),"adminEventdelete"===a.event&&Array.isArray(a.user_id)&&a.user_id.includes(r.id)&&(console.log("New notification delete event:",a.message),te(!0),s()),"adminEventPostdelete"===a.event&&Array.isArray(a.user_id)&&a.user_id.includes(r.id)&&(te(!0),s()),"adminEventPostCommentEdit"===a.event&&Array.isArray(a.user_id)&&a.user_id.includes(r.id)&&(te(!0),s()),"adminGroupedit"!==a.event&&"adminGroupdelete"!==a.event&&"adminGroupPostCommentEdit"!==a.event&&"adminGroupPostdelete"!==a.event&&"adminGalleryPostdelete"!==a.event&&"adminGallerydelete"!==a.event&&"adminForumPostdelete"!==a.event&&"adminGalleryPostUpdate"!==a.event&&"adminForumPostupdate"!==a.event||Array.isArray(a.user_id)&&a.user_id.includes(r.id)&&(te(!0),s()),"gallerynotification"===a.event&&Array.isArray(a.user_id)&&a.user_id.some((e=>e.id===r.id))&&(te(!0),s()),"grouprequest_acceptnotification"===a.event&&Array.isArray(a.user_id)&&a.user_id.some((e=>e.id===r.id))&&(te(!0),s()),"eventrequest_acceptnotification"===a.event&&Array.isArray(a.user_id)&&a.user_id.some((e=>e.id===r.id))&&(te(!0),s()),a.event}catch(a){}},e.onopen=()=>{console.log("WebSocket connection established")},e.onerror=e=>{console.error("WebSocket error:",e)},()=>{e.close(),console.log("WebSocket connection closed")}}),[s]),(0,n.useEffect)((()=>{}),[]),(0,n.useEffect)((()=>{const e=setInterval((async()=>{const e=localStorage.getItem("userLogin"),s=e?JSON.parse(e):null;if(!s||!s.id)return void console.error("User login information is not available.");let a={user_id:s.id};try{(await o.A.post(je+"useractivity",a,{headers:{Accept:"application/json","Content-Type":"application/json"}})).data.results}catch(n){n.response?console.error("Server responded with an error:",n.response.data):n.request?console.error("No response from server. Request details:",n.request):console.error("Error occurred:",n.message)}}),1e3);return()=>clearInterval(e)}),[]);var je="https://backend.amourette.no/api/members/";(0,n.useEffect)((()=>{const e=localStorage.getItem("userLogin"),s=JSON.parse(e);if(console.log("dff"),console.log(s),null===s||"null"===s)return localStorage.removeItem("userLogin"),void ge("/login");return(async()=>{if(!s||"null"===s)return localStorage.removeItem("userLogin"),void ge("/login");let e={id:s.id,email:s.email};try{const s=await o.A.post("https://backend.amourette.no/api/getUserDetail",e,{headers:{Accept:"application/json","Content-Type":"application/json"}});console.log("sd"),console.log(s.data.result),""===s.data.result&&(localStorage.removeItem("userLogin"),ge("/login")),console.log(s.data),de(s.data.result)}catch(a){a.response||(a.request?console.error("Request data:",a.request):console.error("Error message:",a.message))}})(),_e(),window.addEventListener("scroll",xe),()=>{window.removeEventListener("scroll",xe)}}),[]);const ve=async()=>{const e=localStorage.getItem("userLogin");if(e){const a={user_id:JSON.parse(e).id};try{const e=await o.A.post(M+"/setonline",a,{headers:{Accept:"application/json","Content-Type":"application/json"}});H(e.data.onlineCount)}catch(s){console.error("Error setting user online:",s.response?s.response.data:s.message)}}},Ne=async()=>{const e=localStorage.getItem("userLogin");if(e){const a={user_id:JSON.parse(e).id};try{await o.A.post(M+"/setoffline",a,{headers:{Accept:"application/json","Content-Type":"application/json"}})}catch(s){console.error("Error setting user offline:",s.response?s.response.data:s.message)}}};(0,n.useEffect)((()=>{U?ve():Ne();const e=()=>{W(!0)},s=()=>{W(!1)};return window.addEventListener("online",e),window.addEventListener("offline",s),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",s)}}),[]),(0,n.useEffect)((()=>{U?ve():Ne()}),[U]),(0,n.useEffect)((()=>{const e=localStorage.getItem("userSearch"),s=e?JSON.parse(e):null;if(null!==s)var a=s.search;else a="";X(a)}),[U]);const _e=async()=>{const e=localStorage.getItem("userLogin");let s={user_id:JSON.parse(e).id};try{var a=(await o.A.post(M+"getReceivedMessageheader",s,{headers:{Accept:"application/json","Content-Type":"application/json"}})).data.results;console.log(a),D(a)}catch(n){n.response||n.request}},we=e=>{if(!e)return null;const s=new Date(e);if(isNaN(s.getTime()))return console.error("Invalid date:",e),"Invalid date";const a=new Date,n=new Date(s.getTime()-36e5),r=new Intl.DateTimeFormat("en-GB",{timeZone:"Europe/Oslo",hour:"2-digit",minute:"2-digit",hour12:!1}).format(n),t=a.getTime()-s.getTime(),l=Math.floor(t/1e3),i=Math.floor(l/60),o=Math.floor(i/60),c=Math.floor(o/24),d=Math.floor(c/7),u=Math.floor(c/30),m=Math.floor(c/365);return i<60||o<24?`${r}`:1===c?`Yesterday at ${r}`:c<7?`${c}d  ${r}`:d<4?`${d}w  ${r}`:u<12?`${u}m  ${r}`:`${m}y  ${r}`},ye=e=>{S.A.changeLanguage(e),localStorage.setItem("language",e)},{t:be}=(0,b.Bd)();return(0,n.useEffect)((()=>{let e=["/searchpeople","/searchpost","/searchgroup","/searchevent","/searchforum","/searchmember","/searchspeeddate"].includes(E.pathname)?E.pathname:"/searchtop?q="+V;setTimeout((()=>{$(e)}),100)}),[E.pathname,V]),(0,n.useEffect)((()=>{const e=localStorage.getItem("language")||"en";S.A.language!==e&&S.A.changeLanguage(e)}),[S.A,be]),(0,n.useEffect)((()=>{const e=e=>{if(console.log(O),""!==O&&""!==V.trim()&&"Enter"===e.key){e.preventDefault();let s=O.includes("?q=")?O:`${O}?q=${encodeURIComponent(V)}`;window.location.href=s}};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[O,V]),(0,A.jsxs)(A.Fragment,{children:[Z&&(0,A.jsx)(y.A,{message:Q}),(0,A.jsx)("header",{className:"header "+(he?"sticky":""),children:(0,A.jsx)("div",{className:"container-lg",children:(0,A.jsxs)("div",{className:"row gy-3 align-items-center",children:[(0,A.jsx)("div",{className:"col-8 col-md-3",children:(0,A.jsx)(r.N_,{to:"/",className:"toplogo d-inline-block fulw",children:(0,A.jsx)("img",{src:c,alt:"Logo"})})}),(0,A.jsx)("div",{className:"col-md-3",children:(0,A.jsx)("div",{className:"d-block topsearch",children:(0,A.jsxs)("form",{action:"javascript:void(0)",children:[(0,A.jsx)("input",{type:"text",value:L,placeholder:be("headerSearch"),onInput:e=>{const s=e.target.value;C(s),X(s),J(!0);const a=["/searchpeople","/searchpost","/searchgroup","/searchevent","/searchforum","/searchmember","/searchspeeddate"];""!==s?J(!0):(a.includes(E.pathname)&&(window.location.href=E.pathname),J(!1))}}),G&&(0,A.jsx)("ul",{className:"similar_search",children:(0,A.jsx)("li",{children:(0,A.jsxs)("a",{href:O,children:[(0,A.jsx)("div",{className:"block search_icon",children:(0,A.jsx)("img",{className:"w-100 h-100 object-fit-cover",src:a(4319),alt:"Profile"})}),(0,A.jsx)("span",{children:V})]})})})]})})}),(0,A.jsx)("div",{className:" col-md-6",children:(0,A.jsx)("div",{className:"d-flex flex-column flex-md-row  justify-content-md-end",children:(0,A.jsx)("div",{className:"d-flex flex-column flex-md-row ",children:(0,A.jsxs)("div",{className:"d-flex gap-md-3 gap-1 flex-wrap rel align-items-md-center justify-content-between justify-content-md-end",children:[(0,A.jsxs)("div",{className:"",children:[(0,A.jsx)("button",{type:"button",className:"topmenu "+("menu1"===ue?"active":""),onClick:()=>le("menu1"),children:(0,A.jsx)("img",{className:"object-contain",src:d,alt:"userp"})}),(0,A.jsx)("div",{className:"menubox",style:{display:"menu1"===ue?"block":"none"},children:(0,A.jsxs)("div",{className:"d-flex flex-column gap-4 ",children:[(0,A.jsx)("h3",{children:be("Menu")}),(0,A.jsxs)("div",{className:"d-flex flex-column gap-3",children:[(0,A.jsxs)(r.N_,{to:"/friendsearch",className:"d-flex gap-3",children:[(0,A.jsx)("div",{className:"flex-shrink-0",children:(0,A.jsx)("div",{className:"iconmenu fulw",children:(0,A.jsx)("img",{src:m,alt:"userpic"})})}),(0,A.jsxs)("div",{className:"flex-grow-1",children:[(0,A.jsx)("h4",{children:be("LeftMenu_Members")}),(0,A.jsx)("p",{children:be("view_and_browser")})]})]}),(0,A.jsxs)(r.N_,{to:"/receivedmessages",className:"d-flex gap-3",children:[(0,A.jsx)("div",{className:"flex-shrink-0",children:(0,A.jsx)("div",{className:"iconmenu fulw",children:(0,A.jsx)("img",{src:h,alt:"userpic"})})}),(0,A.jsxs)("div",{className:"flex-grow-1",children:[(0,A.jsx)("h4",{children:be("Messages")}),(0,A.jsx)("p",{children:be("view_received_and_sent")})]})]}),(0,A.jsxs)(r.N_,{to:"/allgallery",className:"d-flex gap-3",children:[(0,A.jsx)("div",{className:"flex-shrink-0",children:(0,A.jsx)("div",{className:"iconmenu fulw",children:(0,A.jsx)("img",{src:p,alt:"userpic"})})}),(0,A.jsxs)("div",{className:"flex-grow-1",children:[(0,A.jsx)("h4",{children:be("Gallery")}),(0,A.jsx)("p",{children:be("view_and_upload_images")})]})]}),(0,A.jsxs)(r.N_,{to:"/allgroup",className:"d-flex gap-3",children:[(0,A.jsx)("div",{className:"flex-shrink-0",children:(0,A.jsx)("div",{className:"iconmenu fulw",children:(0,A.jsx)("img",{src:x,alt:"userpic"})})}),(0,A.jsxs)("div",{className:"flex-grow-1",children:[(0,A.jsx)("h4",{children:be("Groups")}),(0,A.jsx)("p",{children:be("Browse_and_create_groups")})]})]}),(0,A.jsxs)(r.N_,{to:"/allevents",className:"d-flex gap-3",children:[(0,A.jsx)("div",{className:"flex-shrink-0",children:(0,A.jsx)("div",{className:"iconmenu fulw",children:(0,A.jsx)("img",{src:g,alt:"userpic"})})}),(0,A.jsxs)("div",{className:"flex-grow-1",children:[(0,A.jsx)("h4",{children:be("LeftMenu_Events")}),(0,A.jsx)("p",{children:be("Browse_and_create_events")})]})]}),(0,A.jsxs)(r.N_,{to:"/speeddate",className:"d-flex gap-3",children:[(0,A.jsx)("div",{className:"flex-shrink-0",children:(0,A.jsx)("div",{className:"iconmenu fulw",children:(0,A.jsx)("img",{src:f,alt:"userpic"})})}),(0,A.jsxs)("div",{className:"flex-grow-1",children:[(0,A.jsx)("h4",{children:be("LeftMenu_Speedating")}),(0,A.jsx)("p",{children:be("Meet_new_people")})]})]}),(0,A.jsxs)(r.N_,{to:"/allforums",className:"d-flex gap-3",children:[(0,A.jsx)("div",{className:"flex-shrink-0",children:(0,A.jsx)("div",{className:"iconmenu fulw",children:(0,A.jsx)("img",{src:j,alt:"userpic"})})}),(0,A.jsxs)("div",{className:"flex-grow-1",children:[(0,A.jsx)("h4",{children:be("Forum")}),(0,A.jsx)("p",{children:be("Browse_and_create_forum_threads")})]})]})]})]})})]}),(0,A.jsx)(i.A,{activeMenu:ue,toggleMenu:le,refresh:re}),(0,A.jsxs)("div",{className:"",children:[(0,A.jsx)("button",{type:"button",className:"topmenu "+("menu3"===ue?"active":""),onClick:()=>le("menu3"),children:(0,A.jsx)("img",{className:"object-fit-contain",src:u,alt:"userp"})}),(0,A.jsx)("div",{className:"menubox",style:{display:"menu3"===ue?"block":"none"},children:(0,A.jsxs)("div",{className:"d-flex flex-column gap-4 ",children:[(0,A.jsx)("h3",{children:be("Inbox")}),(0,A.jsx)("div",{className:"d-block inboxser",children:(0,A.jsx)("form",{action:"",children:(0,A.jsx)("input",{type:"text",value:B,onChange:async e=>{const s=localStorage.getItem("userLogin"),a=JSON.parse(s);if(F(e.target.value),""===e.target.value)_e();else{let s={search:e.target.value,user_id:a.id};try{var n=(await o.A.post(M+"getReceivedMessageheaderSearch",s,{headers:{Accept:"application/json","Content-Type":"application/json"}})).data.results;D(n)}catch(r){r.response||r.request}}},placeholder:be("searchinbox")})})}),(0,A.jsx)("div",{className:"d-block inboxser morebtnnotification",children:(0,A.jsx)("button",{type:"button",onClick:()=>{if(q.current){const e=q.current.querySelectorAll(".chat-link");let s=100;e.forEach(((e,a)=>{const n=e.getAttribute("data-url");console.log(n,s),n&&(setTimeout((()=>{window.open(n,"_blank")}),s),s*=2)}))}},className:"float-end",children:be("All_message")})}),(0,A.jsx)("div",{className:"d-flex flex-column gap-3",children:(0,A.jsx)("div",{className:"d-flex flex-column gap-3 scroll_bar scrollyover",ref:q,children:0===R.length?(0,A.jsx)("p",{children:be("No_inbox_found")}):R.map((e=>{const s=e.user_id===P.id,n=s?e.recipient_profile:e.sender_profile,t=s?e.recipient_username:e.sender_username,l=`/receivedchatmessage/${s?e.recipient_slug:e.sender_slug}`;return(0,A.jsxs)(r.N_,{to:l,className:"d-flex gap-3 chat-link","data-url":l,children:[(0,A.jsx)("div",{className:"flex-shrink-0",children:(0,A.jsx)("div",{className:"iconmenu ofit rounded-circle overflow-hidden",children:n?(0,A.jsx)("img",{src:n,alt:"userpic"}):(0,A.jsx)("img",{src:a(7123),alt:"userpic"})})}),(0,A.jsxs)("div",{className:"flex-grow-1",children:[(0,A.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,A.jsx)("h4",{children:t})," ",(0,A.jsx)("p",{children:we(e.date)})," "]}),(0,A.jsxs)("h6",{className:"minimsg",children:[e.message," "]})]})]},e.id)}))})})]})})]}),(0,A.jsxs)("div",{className:"",children:[(0,A.jsx)("button",{type:"button",className:"topmenu rounded-circle overflow-hidden p-0 "+("menu4"===ue?"active":""),onClick:()=>le("menu4"),children:1===ce.makeImagePrivate?(0,A.jsx)("img",{src:a(7123),alt:"userpic",className:"rounded-circle overflow-hidden"}):(0,A.jsx)("img",{src:ce.profile_image,alt:"userpic",className:"rounded-circle overflow-hidden"})}),(0,A.jsx)("div",{className:"menubox",style:{display:"menu4"===ue?"block":"none"},children:(0,A.jsxs)("div",{className:"d-flex flex-column gap-4 ",children:[(0,A.jsx)("h3",{children:be("Profile_and_settings")}),(0,A.jsxs)("div",{className:"d-flex flex-column gap-3",children:[(0,A.jsxs)(r.N_,{to:"/editprofile",className:"d-flex align-items-center gap-3",children:[(0,A.jsx)("div",{className:"flex-shrink-0",children:(0,A.jsx)("div",{className:"iconmenu ofit rounded-circle overflow-hidden",children:ce.profile_image&&0===ce.makeImagePrivate?(0,A.jsx)("img",{src:ce.profile_image,alt:"userpic"}):(0,A.jsx)("img",{src:a(7123),alt:"userpic"})})}),(0,A.jsxs)("div",{className:"flex-grow-1",children:[(0,A.jsx)("h4",{children:ce.username}),(0,A.jsx)("p",{children:be("Edit_your_profile")})]})]}),(0,A.jsx)("div",{className:"d-block morebtn",children:(0,A.jsx)("button",{type:"button",onClick:()=>{oe(!0),document.body.style.overflowY="hidden"},children:be("UPGRADE_MEMBERSHIP")})}),(0,A.jsxs)("div",{className:"d-flex flex-column gap-3 helpset pt-3",children:[(0,A.jsxs)(r.N_,{to:"/setting",className:"d-flex gap-3",children:[(0,A.jsx)("div",{className:"flex-shrink-0",children:(0,A.jsx)("div",{className:"iconmenu fulw",children:(0,A.jsx)("img",{src:v,alt:"userpic"})})}),(0,A.jsxs)("div",{className:"flex-grow-1",children:[(0,A.jsx)("h4",{children:be("Settings")}),(0,A.jsx)("p",{children:be("Site_and_profile_settings")})]})]}),(0,A.jsxs)(r.N_,{to:"/helpsupport",className:"d-flex gap-3",children:[(0,A.jsx)("div",{className:"flex-shrink-0",children:(0,A.jsx)("div",{className:"iconmenu fulw",children:(0,A.jsx)("img",{src:_,alt:"userpic"})})}),(0,A.jsxs)("div",{className:"flex-grow-1",children:[(0,A.jsx)("h4",{children:be("Help_and_support")}),(0,A.jsx)("p",{children:be("Contact_us_FAQ_and_more")})]})]}),(0,A.jsxs)(r.N_,{to:"#",onClick:()=>{document.cookie="gdprConsent=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/;",window.location.href="/logout"},className:"d-flex gap-3",children:[(0,A.jsx)("div",{className:"flex-shrink-0",children:(0,A.jsx)("div",{className:"iconmenu fulw",children:(0,A.jsx)("img",{src:N,alt:"userpic"})})}),(0,A.jsxs)("div",{className:"flex-grow-1",children:[(0,A.jsx)("h4",{children:be("Log_out")}),(0,A.jsx)("p",{children:be("See_you_later")})]})]})]})]})]})})]}),(0,A.jsxs)("div",{className:"d-flex align-items-center gap-1 lang_chnage",children:[(0,A.jsx)("button",{className:"flex-shrink-0 "+("en"===S.A.language?"active":""),type:"button",onClick:()=>ye("en"),children:"EN"}),(0,A.jsx)("h6",{className:"flex-shrink-0",children:"-"}),(0,A.jsx)("button",{className:"flex-shrink-0 "+("no"===S.A.language?"active":""),type:"button",onClick:()=>ye("no"),children:"NO"})]})]})})})})]})})}),(0,A.jsx)(l.l,{isOpen:ie,onClose:()=>{oe(!1),document.body.style.overflowY="auto"}}),(0,A.jsx)(t.A,{}),(0,A.jsx)(k.A,{})]})}}}]);
//# sourceMappingURL=5700.eb873999.chunk.js.map